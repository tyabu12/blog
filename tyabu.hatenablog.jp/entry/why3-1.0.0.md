---
Title: 証明プラットフォーム Why3 1.0.0 がリリース
Date: 2018-06-28T19:04:39+09:00
URL: https://tyabu.hatenablog.jp/entry/why3-1.0.0
EditURL: https://blog.hatena.ne.jp/tyabu12/tyabu.hatenablog.jp/atom/entry/17391345971658528106
Draft: true
---

証明プラットフォーム Why3 1.0.0 がリリース
===

証明プラットフォーム Why3 1.0.0 がリリースされたので、更新内容と
軽く使ってみた所感をざっくり紹介します。

## Why3 とは

[フランス国立情報学自動制御研究所 (INRIA)](https://www.inria.fr/) が開発した、
プログラム検証のための証明プラットフォームです。

[Why3 の公式HP](http://why3.lri.fr)


### 特長

- プログラムの記述には OCaml をベースにした関数型言語 (WhyML) を採用
  - WhyML → OCaml のエンコード (extract) も可能
- 関数に検証したい仕様 (事前条件、事後条件など) を付与すると、満たすべき検証条件を自動計算できる
- 検証条件の検証は、SMTソルバーや定理証明支援系にいい感じに自動エンコードしたものを渡して
  外部に丸投げできる
  - [対応している外部証明器の一覧](http://why3.lri.fr/#provers)
- 上記の一連の操作が可能な IDE

まあかなりざっくり検証の手順を書くと、

1. プログラムを OCaml (ライクの言語) で書いて
2. 検証したい性質を仕様として足して
3. IDE から証明器のボタンをポチッと押せば
4. お手軽に検証できちゃう

って感じです。


## 1.0.0 の主な変更点

以下は [Why3 のメーリングリスト](https://lists.gforge.inria.fr/mailman/listinfo/why3-club) 
の意訳+独自の補足です。
[原文はこちら](https://lists.gforge.inria.fr/pipermail/why3-club/2018-June/001745.html)

前のリリース (ver.0.88.3) からの変更は、大きく2つ。

1. WhyML プログラミング言語と関連した VC 生成器
2. IDE によるユーザーインターフェースの改良


### 1. WhyML プログラミング言語と、それに関する検証条件生成器

簡潔にまとめると、論理とプログラムで使われる関数の厳格で明確な区別をするようになったことです。

以前までは、Why3 言語と呼ばれる論理記述言語  (紛らわしい) と、WhyML と呼ばれる
プログラミング言語が存在していました。

この言語をそれぞれ分けた問題として、ある関数を WhyMLで書いて検証した関数を、
今度は Why3 言語側に書いて別の関数の仕様を記述に使う、といったことができませんでした
(どうしてもしたいなら手で書き直す必要があり、えっ‥という感じでした) 。

今回の更新ではこういうったことが可能になるよう、論理もプログラムもすべて WhyML 言語で
書くことになり、それに伴い Why3 言語は廃止されました。
もちろん以前のコードは新しい構文に対応するよう書き直す必要があります。

以前の構文との簡単な対応関係は、ドキュメントの [付録A](http://why3.lri.fr/doc/changes.html#sec112) 
に記載されています。まだ [構文のリファレンス](http://why3.lri.fr/doc/syntaxref.html) は
公開されていませんがが、近々掲載予定とのことです。

注意点としては、以前までできていた論理側に書いた関数 (`function` で書いた関数) をプログラム側で使おうとすると、
エラーが出るようになりました (`let function` に直せとのこと) 。


### 2. IDE によるユーザーインターフェース

Why3 にはもともと GUI による IDE があったが、今回の更新で見た目がかなり変更された。

もともと、検証条件の変形や証明器による検証などの操作ボタンは左にボタンが羅列されていたが、
今回の変更で右クリックによるコンテキストメニューから操作することになった。

あと個人的に嬉しかった変更は、IDE 上から直接 WhyML のソースコードを編集できるようになったこと
ですね。今までは IDE なのになんで編集できないんだって感じだったので。


### 所感

今回の更新は、今まで不便だなと感じていた点が結構解決された感じなので、
良いメジャーアップデートだと思います。

特に言語の構文は、論理とプログラムの仕様が若干曖昧なために、
ユーザー側の認識も曖昧になりがちだったので、構文として明確になったのはかなり良かったと思います。

ただ構文の大幅な変更やそれに伴う標準ライブラリの更新などにまだバグがありそうな感じなので、
しばらくは試験運用しつつバグを見つけたら [報告](https://gitlab.inria.fr/why3/why3/issues) して修正が必要かな、という感じです。
